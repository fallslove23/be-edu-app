# ì•Œë¦¼ ì‹œìŠ¤í…œ ì„¤ì • ê°€ì´ë“œ ğŸ””

## ë¬¸ì œ ìƒí™©
ì½˜ì†”ì— "ì•Œë¦¼ ë¡œë“œ ì‹¤íŒ¨: {}" ì—ëŸ¬ê°€ í‘œì‹œë©ë‹ˆë‹¤.

## ì›ì¸
ë°ì´í„°ë² ì´ìŠ¤ì— `notifications` í…Œì´ë¸”ì´ ìƒì„±ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

## í•´ê²° ë°©ë²• (5ë¶„ ì†Œìš”)

### 1ë‹¨ê³„: Supabase SQL Editor ì—´ê¸°

1. Supabase ëŒ€ì‹œë³´ë“œ ì ‘ì†: https://supabase.com/dashboard
2. í”„ë¡œì íŠ¸ ì„ íƒ
3. ì™¼ìª½ ë©”ë‰´ì—ì„œ **SQL Editor** í´ë¦­

### 2ë‹¨ê³„: SQL ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰

ì•„ë˜ SQLì„ ë³µì‚¬í•˜ì—¬ SQL Editorì— ë¶™ì—¬ë„£ê³  **Run** ë²„íŠ¼ í´ë¦­:

```sql
-- 1. notifications í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS public.notifications (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL,
  type VARCHAR(50) NOT NULL,
  title VARCHAR(255) NOT NULL,
  message TEXT NOT NULL,
  link VARCHAR(500),
  related_course_id UUID,
  related_session_id UUID,
  is_read BOOLEAN DEFAULT false,
  priority VARCHAR(20) DEFAULT 'normal',
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  read_at TIMESTAMP WITH TIME ZONE
);

-- 2. notification_preferences í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS public.notification_preferences (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID NOT NULL UNIQUE,
  course_start_enabled BOOLEAN DEFAULT true,
  course_update_enabled BOOLEAN DEFAULT true,
  conflict_enabled BOOLEAN DEFAULT true,
  course_confirmed_enabled BOOLEAN DEFAULT true,
  session_change_enabled BOOLEAN DEFAULT true,
  days_before_start INTEGER DEFAULT 3,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- 3. scheduled_notifications í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS public.scheduled_notifications (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  course_round_id UUID,
  notification_type VARCHAR(50) NOT NULL,
  scheduled_date DATE NOT NULL,
  is_sent BOOLEAN DEFAULT false,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  sent_at TIMESTAMP WITH TIME ZONE
);

-- 4. ì¸ë±ìŠ¤ ìƒì„±
CREATE INDEX IF NOT EXISTS idx_notifications_user ON public.notifications(user_id);
CREATE INDEX IF NOT EXISTS idx_notifications_type ON public.notifications(type);
CREATE INDEX IF NOT EXISTS idx_notifications_read ON public.notifications(is_read);
CREATE INDEX IF NOT EXISTS idx_notifications_created ON public.notifications(created_at DESC);

-- 5. RLS ë¹„í™œì„±í™” (Mock Auth ì‚¬ìš©)
ALTER TABLE public.notifications DISABLE ROW LEVEL SECURITY;
ALTER TABLE public.notification_preferences DISABLE ROW LEVEL SECURITY;
ALTER TABLE public.scheduled_notifications DISABLE ROW LEVEL SECURITY;

-- ì™„ë£Œ!
SELECT 'âœ… ì•Œë¦¼ ì‹œìŠ¤í…œ í…Œì´ë¸” ìƒì„± ì™„ë£Œ!' as message;
```

### 3ë‹¨ê³„: ê²°ê³¼ í™•ì¸

SQL ì‹¤í–‰ í›„ ë‹¤ìŒ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ë©´ ì„±ê³µ:
```
âœ… ì•Œë¦¼ ì‹œìŠ¤í…œ í…Œì´ë¸” ìƒì„± ì™„ë£Œ!
```

### 4ë‹¨ê³„: ì• í”Œë¦¬ì¼€ì´ì…˜ í™•ì¸

1. ë¸Œë¼ìš°ì €ì—ì„œ ì•± ìƒˆë¡œê³ ì¹¨ (Ctrl+Shift+R ë˜ëŠ” Cmd+Shift+R)
2. ê°œë°œì ë„êµ¬ ì½˜ì†” í™•ì¸
3. ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì‚¬ë¼ì¡ŒëŠ”ì§€ í™•ì¸
4. ìƒë‹¨ì˜ ì•Œë¦¼ ë²¨ ğŸ”” ì•„ì´ì½˜ í´ë¦­í•˜ì—¬ ì •ìƒ ì‘ë™ í™•ì¸

## í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ìƒì„± (ì„ íƒì‚¬í•­)

í…ŒìŠ¤íŠ¸ ì•Œë¦¼ì„ ìƒì„±í•˜ë ¤ë©´ SQL Editorì—ì„œ ì‹¤í–‰:

```sql
-- ì²« ë²ˆì§¸ ì‚¬ìš©ìì—ê²Œ í…ŒìŠ¤íŠ¸ ì•Œë¦¼ ìƒì„±
INSERT INTO public.notifications (user_id, type, title, message, priority)
SELECT id, 'course_start', 'ğŸ‰ ì•Œë¦¼ ì‹œìŠ¤í…œ í™œì„±í™”', 'ì•Œë¦¼ ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•©ë‹ˆë‹¤!', 'normal'
FROM public.users
LIMIT 1;
```

## ë¬¸ì œê°€ ê³„ì†ë˜ëŠ” ê²½ìš°

### 1. í…Œì´ë¸” ì¡´ì¬ ì—¬ë¶€ í™•ì¸

SQL Editorì—ì„œ ì‹¤í–‰:

```sql
SELECT
  table_name,
  EXISTS (
    SELECT FROM information_schema.tables
    WHERE table_schema = 'public'
    AND information_schema.tables.table_name = pg_tables.tablename
  ) as exists
FROM pg_tables
WHERE schemaname = 'public'
AND tablename IN ('notifications', 'notification_preferences', 'scheduled_notifications');
```

ëª¨ë“  í…Œì´ë¸”ì˜ `exists`ê°€ `true`ì—¬ì•¼ í•©ë‹ˆë‹¤.

### 2. RLS ìƒíƒœ í™•ì¸

```sql
SELECT
  tablename,
  rowsecurity as rls_enabled
FROM pg_tables
WHERE schemaname = 'public'
AND tablename IN ('notifications', 'notification_preferences', 'scheduled_notifications');
```

ëª¨ë“  í…Œì´ë¸”ì˜ `rls_enabled`ê°€ `false`ì—¬ì•¼ í•©ë‹ˆë‹¤.

### 3. ì—°ê²° ì •ë³´ í™•ì¸

`.env.local` íŒŒì¼ì—ì„œ ë‹¤ìŒ í™•ì¸:
- `VITE_SUPABASE_URL`: Supabase í”„ë¡œì íŠ¸ URL
- `VITE_SUPABASE_ANON_KEY`: Supabase Anon Key

## ì•Œë¦¼ ì‹œìŠ¤í…œ ê¸°ëŠ¥

### ì§€ì›ë˜ëŠ” ì•Œë¦¼ ìœ í˜•
- ğŸ“š **ê³¼ì • ì‹œì‘ ì•Œë¦¼**: ê³¼ì • ì‹œì‘ ë©°ì¹  ì „ ì•Œë¦¼
- ğŸ“ **ê³¼ì • ë³€ê²½ ì•Œë¦¼**: ê³¼ì • ì •ë³´ ë³€ê²½ ì‹œ ì•Œë¦¼
- âš ï¸ **ì¶©ëŒ ê°ì§€ ì•Œë¦¼**: ê°•ì˜ì‹¤/ê°•ì‚¬ ì¼ì • ì¶©ëŒ ê°ì§€
- âœ… **ê³¼ì • í™•ì • ì•Œë¦¼**: ê³¼ì • í™•ì • ì‹œ ì•Œë¦¼
- ğŸ“… **ì¼ì • ë³€ê²½ ì•Œë¦¼**: ì„¸ì…˜ ì¼ì • ë³€ê²½ ì‹œ ì•Œë¦¼

### ìš°ì„ ìˆœìœ„
- ğŸš¨ ê¸´ê¸‰ (urgent): ë¹¨ê°„ìƒ‰
- âš¡ ë†’ìŒ (high): ì£¼í™©ìƒ‰
- â„¹ï¸ ë³´í†µ (normal): íŒŒë€ìƒ‰
- ğŸ“Œ ë‚®ìŒ (low): íšŒìƒ‰

## ì¶”ê°€ ì •ë³´

- ğŸ“„ ìƒì„¸ ë¬¸ì„œ: `database/README-NOTIFICATIONS-FIX.md`
- ğŸ”§ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼: `database/create-notifications-quick.sql`
- ğŸ’» ì»´í¬ë„ŒíŠ¸: `src/components/notifications/NotificationCenter.tsx`

## ì™„ë£Œ! ğŸ‰

ì•Œë¦¼ ì‹œìŠ¤í…œì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤.
ìƒë‹¨ì˜ ì•Œë¦¼ ë²¨ ì•„ì´ì½˜ì„ í´ë¦­í•˜ì—¬ í™•ì¸í•˜ì„¸ìš”!
